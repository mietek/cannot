@function em($n)
  @return font-size($n) * 1px

@function ln($n)
  @return line-height($n) * 1px


@import "cannot/layout/button"

@import "cannot/toggle"


::selection
  background-color: rgba($accent-color, 0.2)

::-moz-selection
  background-color: rgba($accent-color, 0.2)


body
  font-size: em(1)
  line-height: ln(1)

footer aside
  font-size: em(3/4)
  padding-top: em(3/4) // To counter font-size

footer aside p:first-of-type
  margin-top: 0

em, i
  font-style: italic

strong, b
  font-weight: bold

code
  font-family: monospace
  font-size: em(12/14)
  line-height: ln(12/14)

.small-caps
  font-variant: small-caps

img
  max-width: 100%
  height: auto


// To get above main
header
  position: relative
  z-index: 1

header a
  @include no-underline

header div.wrapper > *
  margin-right: ln(1)

header div.wrapper > nav
  margin-left: 0
  margin-right: 0


main
  margin-top: ln(-2)
  padding-bottom: ln(6)

main > .wrapper:first-of-type > section:first-of-type
  padding-top: ln(6)


section
  position: relative // For .backlink-button

section > *
  margin-right: ln(1)

section div.inner
  margin-right: ln(1)

section > section
  margin-left: 0
  margin-right: 0

section > hr
  margin-left: 0
  margin-right: 0

section aside
  color: $object-color
  font-size: em(3/4)
  padding-bottom: em(1/8) // To counter font-size
  line-height: ln(3/4)

section aside:not(.inline) > *
  margin-left: ln(11/4)

section aside a.face
  margin-left: 0
  margin-top: ln(3/4)

section aside a.face:first-of-type
  margin-top: 0

section aside blockquote
  color: $object-color
  text-indent: -1ex
  margin-top: ln(3/4)

section aside blockquote:first-of-type
  margin-top: 0

section aside p
  margin-top: ln(1/4)
  margin-bottom: 0

section aside a
  @include no-underline

div.aside-like > *
  margin-left: ln(5)

div.aside-like a.face
  margin-left: 0

div.aside-like blockquote
  color: $body-color

section span.backlink-button
  position: absolute // Referencing section
  top: 0
  right: 0
  margin-left: 0
  margin-right: 0

section span.backlink-button a
  @include block-button
  @include smart-icon-after("up", $object-color-name, $accent-color-name)

section p
  margin-top: ln(1/2)
  margin-bottom: ln(1/2)

section p > code, section em > code, section li > code, section td > code, section td > a > code
  word-wrap: break-word

section p > code, section em > code, section li > code, section td > code
  color: $object-color

section table
  table-layout: fixed
  width: 100%
  margin-right: ln(1)
  margin-top: ln(1/2)
  margin-bottom: ln(1)

section table thead
  width: 100%

section table tbody
  width: 100%

section table tr
  width: 100%

section table th
  color: $subject-color

section table th:first-of-type
  width: (1/3) * 100%

section table td:first-of-type
  width: (1/3) * 100%

section table th:not(:first-of-type)
  padding-left: ln(1)

section table td:not(:first-of-type)
  padding-left: ln(1)

section > table th:last-of-type
  padding-right: ln(1)

section > table td:last-of-type
  padding-right: ln(1)

section ul
  margin-top: ln(1/2)

section ul > li
  margin-left: ln(1)
  min-height: ln(1)
  position: relative

section ul > li:before
  color: $accent-color
  content: "â€¢"
  position: absolute
  left: ln(-1)
  top: 0

section ol
  margin-top: ln(1/2)
  counter-reset: numbered-list

section ol > li
  margin-left: ln(1)
  min-height: ln(1)
  position: relative

section ol > li:before
  color: $accent-color
  content: counter(numbered-list)
  counter-increment: numbered-list
  position: absolute
  left: ln(-1)
  top: 0

section blockquote
  margin-top: ln(1/2)
  color: $subject-color

// NOTE: Without this, a bug in WebKit shows a different color for text-decoration than for text.
section blockquote :not(a) > code
  color: $object-color

section blockquote a
  color: $object-color
  @include frob-when-frobbed
    color: $accent-color

section div.pre-like
  background-color: #fcfbfa
  color: $object-color
  padding-top: ln(1/2)
  padding-bottom: ln(1/2)
  padding-right: ln(1)
  margin-left: 0
  margin-right: 0
  margin-top: ln(1/2)
  margin-bottom: ln(1/2)

section pre
  background-color: #fcfbfa
  color: $object-color
  padding-top: ln(1/2)
  padding-bottom: ln(1/2)
  padding-right: ln(1)
  overflow-x: auto
  margin-left: 0
  margin-right: 0
  margin-top: ln(1/2)
  margin-bottom: ln(1/2)

section pre span.prompt
  color: $accent-color
  font-weight: bold

section pre span.input
  color: $body-color

section pre + p
  margin-top: ln(1)

section ul
  margin-top: ln(1/2)
  margin-bottom: ln(1/2)

section ul + ul
  margin-top: -ln(1/2)

section hr
  @include rule-after(rgba($accent-color, 0.8))
  border: none
  height: ln(1/2)
  margin-top: ln(3)
  margin-bottom: ln(1)

section.level1
  margin-top: ln(6)
  &:first-of-type
    margin-top: 0

.rule-before-h1 section.level1
  @include rule-before(rgba($accent-color, 0.8))
  margin-top: ln(6)

.hairline.rule-before-h1 section.level1:before
  border-width: 0.5px

section h1
  color: $accent-color
  font-size: em(2)
  font-weight: bold
  line-height: ln(2)
  margin-bottom: ln(1)

section h1 code
  font-size: em((12/14) * 2)
  word-wrap: break-word

section h1 a
  @include no-underline
  color: $accent-color
  @include frob-when-frobbed
    color: $accent-color

section.level2
  @include rule-before(rgba($accent-color, 0.8), $top: ln(-1/2) - 1)
  margin-top: ln(4)

section.level2.no-rule-before-h2
  @include rule-before(none)
  margin-top: ln(2)

section h2
  color: $accent-color
  font-size: em(3/2)
  font-weight: bold
  line-height: ln(2)
  margin-bottom: ln(1/2)
  position: relative

section h2 code
  font-size: em((12/14) * (3/2))
  word-wrap: break-word

section h2 a
  @include no-underline
  color: $accent-color
  @include frob-when-frobbed
    color: $accent-color

section.level3
  margin-top: ln(3/2)

.rule-before-h3 section.level3
  @include rule-before(rgba($object-color, 0.2), $top: ln(-1/2) - 1)
  margin-top: ln(5/2)

.hairline.rule-before-h3 section.level3:before
  border-width: 0.5px

section h3
  color: $accent-color
  font-size: em(5/4)
  line-height: ln(2)
  font-weight: bold
  margin-bottom: ln(1/2)
  position: relative

section h3 code
  font-size: em((12/14) * (5/4))
  word-wrap: break-word

section h3 a
  @include no-underline
  color: $accent-color
  @include frob-when-frobbed
    color: $accent-color

section.level4
  margin-top: ln(1/2)

section.level3 .backlink-button + section.level4
  margin-top: 0

section h4
  color: $accent-color
  font-weight: bold
  padding-top: ln(1/2)
  margin-bottom: ln(1/2)

section h4 a
  @include no-underline
  color: $accent-color
  @include frob-when-frobbed
    color: $accent-color

section.level5
  margin-top: ln(1/2)

section h5
  color: $accent-color
  padding-top: ln(1/2)
  margin-bottom: ln(1/2)

section h5 a
  @include no-underline
  color: $accent-color
  @include frob-when-frobbed
    color: $accent-color

section.level6
  margin-top: ln(1/2)

section h6
  color: $object-color
  font-style: italic
  padding-top: ln(1/2)
  margin-bottom: ln(1/2)

section h6 a
  @include no-underline
  color: $object-color
  @include frob-when-frobbed
    color: $accent-color

section.with-toc nav > ul.toc
  margin-top: ln(1)
  margin-bottom: ln(1)

footer
  padding-bottom: ln(1)
  color: $subject-color

footer a
  @include no-underline

footer div.wrapper > *
  margin-right: ln(1)

footer div.wrapper > nav
  margin-left: 0
  margin-right: 0

footer nav
  @include rule-before(rgba($subject-color, 0.2))


.error-page section p
  font-style: italic
  text-indent: ln(-1)
  padding-left: ln(1)


.face
  @include no-text
  @include smart-opacity(1, 0.8)
  display: block
  float: left
  border: 1px $object-color solid
  border-radius: 50%
  margin-right: ln(1)
  margin-bottom: ln(1)
  transition: ease(opacity, 1, 0)
  .hairline &
    border-width: 0.5px

.micro.face
  margin-right: ln(3/4)
  margin-bottom: 0


#what-browser
  background: rgba(#f00, 0.8)
  background: linear-gradient(to right, rgba(#f00, 0.8) 0%, rgba(white, 0.0) 100%)
  color: white
  bottom: 0
  height: ln(1)
  line-height: ln(1)
  padding-right: ln(1)
  padding-left: ln(1)
  position: fixed
  width: 100%

#what-browser a
  @include smart-text-glow(white)
  @include frob-always
    color: white
    &:after
      border-bottom: 1px rgba(white, 0.4) solid


@import "cannot/layout/menu-bar-common"
@import "cannot/layout/hero-common"

@import "layout/common"
